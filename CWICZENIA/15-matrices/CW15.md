
# Practical Exercise 18 - Introduction to Using Matrices / Ćwiczenie praktyczne 18 – Wprowadzenie do użycia macierzy

---

## **English Version**

### Exercise Description

In this practical exercise, our goal is to deepen our knowledge around how to work with matrices.

Here are the instructions for the exercise:

1. Create a file named `15-matrices.yaml` under the `.github/workflows` folder at the root of your repository.
2. Name the workflow `15 – Working with Matrices`.
3. Add the following triggers with event filters and activity types to your workflow:  
   a. `workflow_dispatch`
4. Add a single job named `backwards-compatibility` to the workflow.  
   a. It should run on `ubuntu-latest`.  
   b. It should use the matrix strategy to define jobs for the following configurations:  
      i. Node versions: `18.x`, `20.x`, and `21.x`.  
      ii. Operating systems: `ubuntu-latest` and `windows-latest`.  
   c. It should be named according to the Node version and OS, following the format `<os>-<node-version>`.  
   d. The job should contain two steps:  
      i. The first step, named **Setup node**, should setup Node according to the version from the matrix.  
      ii. The second step, named **Perform some tests**, should print:  
         `"Running tests on OS <OS value here> and NodeJS <Node version here>"`.

5. Commit the changes and push the code. Trigger the workflow manually from the UI and inspect the result.

6. Extend the `15-matrices.yaml` workflow to include additional combinations:  
   a. Node version `16.x` for the OS `ubuntu-latest`.  
   b. Add a `tag` key with value `experimental` for Node `21.x` on `ubuntu-latest`.

7. Additionally, set the `fail-fast` option under the strategy key to `false`.

8. Add a new step **after Setup node**, named **Fail if experimental**, which should run only if the `tag` key equals `experimental`. The step should simply exit with a non-zero code.

9. Modify the **Perform some tests** step to add a 10-second delay in addition to the original message.

10. Add a final step **after Perform some tests**, named **Upload test results**, which should print `"Uploading test results"`.

11. Commit and push the code. Trigger the workflow manually and inspect the results.

12. Finally, change the `fail-fast` option to `true`, commit again, and observe how this change affects workflow execution.

---

### Tips

**Including and extending specific combinations in a matrix**

To include or extend specific configurations in a matrix, use the `include` option. Example:

```yaml
strategy:
  matrix:
    node-version: [18.x, 20.x]
    os:
      - ubuntu-latest
      - windows-latest
    include:
      - os: ubuntu-latest
        tag: linux
      - os: ubuntu-latest
        node-version: 21.x
```

The above example adds the `tag` key to combinations with `ubuntu-latest`, and adds a new configuration for Node `21.x` on `ubuntu-latest` only (not on `windows-latest`).

---

## **Wersja polska**

### Opis ćwiczenia

W tym ćwiczeniu praktycznym naszym celem jest pogłębienie wiedzy na temat pracy z macierzami (matrices) w workflow GitHub Actions.

Instrukcje do ćwiczenia:

1. Utwórz plik `15-matrices.yaml` w folderze `.github/workflows` w katalogu głównym repozytorium.  
2. Nazwij workflow `15 – Working with Matrices`.  
3. Dodaj następujący wyzwalacz:  
   a. `workflow_dispatch`  
4. Dodaj jedno zadanie `backwards-compatibility`:  
   a. Powinno działać na `ubuntu-latest`.  
   b. Powinno używać strategii macierzy do zdefiniowania konfiguracji:  
      i. Wersje Node: `18.x`, `20.x`, `21.x`.  
      ii. Systemy operacyjne: `ubuntu-latest` i `windows-latest`.  
   c. Nazwa zadania powinna mieć format `<os>-<node-version>`.  
   d. Zawiera dwa kroki:  
      i. **Setup node** – instaluje Node w wersji zdefiniowanej w macierzy.  
      ii. **Perform some tests** – wyświetla komunikat:  
         `"Running tests on OS <wartość OS> and NodeJS <wersja Node>"`.  

5. Zatwierdź zmiany i uruchom workflow ręcznie z UI. Sprawdź wynik działania.

6. Rozszerz plik `15-matrices.yaml`, aby dodać:  
   a. Wersję Node `16.x` dla systemu `ubuntu-latest`.  
   b. Klucz `tag` z wartością `experimental` dla Node `21.x` na `ubuntu-latest`.

7. Ustaw opcję `fail-fast` w strategii na `false`.

8. Dodaj nowy krok **po Setup node**, o nazwie **Fail if experimental**, który powinien działać tylko wtedy, gdy `tag` równa się `experimental`. Krok powinien kończyć się błędem (kod różny od zera).

9. Zmodyfikuj krok **Perform some tests**, aby oprócz wyświetlania komunikatu wstrzymał działanie na 10 sekund.

10. Dodaj krok **Upload test results**, który wyświetla `"Uploading test results"`.

11. Zatwierdź zmiany i uruchom workflow ręcznie, aby przeanalizować wyniki.

12. Zmień opcję `fail-fast` na `true`, zatwierdź ponownie i sprawdź, jak ta zmiana wpływa na przebieg workflow.

---

### Porady

**Dodawanie i rozszerzanie kombinacji w macierzy**

Aby dodać lub rozszerzyć określone kombinacje w macierzy, użyj opcji `include`.  
Przykład:

```yaml
strategy:
  matrix:
    node-version: [18.x, 20.x]
    os:
      - ubuntu-latest
      - windows-latest
    include:
      - os: ubuntu-latest
        tag: linux
      - os: ubuntu-latest
        node-version: 21.x
```

Powyższy przykład dodaje klucz `tag` do wszystkich kombinacji z `ubuntu-latest`, a także dodaje nową kombinację dla Node `21.x` tylko dla `ubuntu-latest` (bez `windows-latest`).

---
