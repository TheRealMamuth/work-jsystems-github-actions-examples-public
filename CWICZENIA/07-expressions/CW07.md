# Practical Exercise 07 — Working with Expressions / Ćwiczenie praktyczne 07 — Praca z wyrażeniami

## EN — Exercise Description
In this practical exercise, our goal is to deepen our knowledge around how to use expressions.

Here are the instructions for the exercise:

1. Create a file named `07-expressions.yaml` under the `.github/workflows` folder at the root of your repository.
2. Name the workflow `07 – Using Expressions`.
3. Add the following triggers with event filters and activity types to your workflow:
   - a. `push`
   - b. `workflow_dispatch`: under the `workflow_dispatch` event trigger, define one input named `debug`, of type `boolean`, and with a default value of `false`.
4. Add a single job named `echo` to the workflow. The job should run on `ubuntu-latest` and should contain three steps:
   - a. The first step, named `[debug] Print start-up data`, should execute only if the `inputs.debug` input is set to `true`. If you are unsure how to do it, check the **Tips** section below. The step should run a multi-line script to print the following data:
     - i. `"Triggered by: <retrieve the event name here>"`
     - ii. `"Branch: <retrieve the ref here>"`
     - iii. `"Commit SHA: <retrieve the commit sha here>"`
     - iv. `"Runner OS: <retrieve the runner os here>"`
   - b. The second step, named `[debug] Print when triggered from main`, should execute only if the `inputs.debug` input is set to `true` **and** the workflow was triggered from the `main` branch. The step should print a single line on the screen: `"I was triggered from main"`.
   - c. The third step, named `Greeting`, should be normally executed and print a `"Hello, world"` message on the screen.
5. Commit the changes and push the code. Take a few moments to inspect the result of the workflow run triggered by the **push** event.
6. Now trigger the workflow manually from the UI, providing enough variations for the `debug` input, and take a few moments to inspect the results. What has changed?
7. Add the `run-name` property to the workflow definition. The `run-name` property should print the following message: `07 – Using Expressions | DEBUG – <'ON' if the debug input is true, 'OFF' otherwise>`
   - a. Expressions allow for default values and ternary operations. These leverage the `&&` and `||` logical operators in the following way:
     - i. **Providing a default:** `${{ expression || default_value }}`. The `default_value` will be used if the expression evaluates to a falsy value.
     - ii. **Using the ternary operation:** `${{ expression && truthy_value || falsy_value }}`. The `truthy_value` will be used if the expression evaluates to a truthy value, and the `falsy_value` will be used otherwise. The actual value resulting from the expression evaluation will not be present in the result of this ternary operation.
8. Commit the changes and push the code. Take a few moments to inspect the result of the workflow run triggered by the **push** event.
9. Now trigger the workflow manually from the UI, providing enough variations for the `debug` input, and take a few moments to inspect the results. What has changed?
10. Change the workflow triggers to contain only `workflow_dispatch` to prevent this workflow from running with every push and polluting the list of workflow runs.

### EN — Tips
**Conditionally executing jobs and steps**  
To execute jobs and steps conditionally, we can leverage the `if` keyword in either the job or the step definition. The `if` keyword accepts an expression, and the job or step will be executed if the expression evaluates to a truthy value; otherwise, the job or step will be skipped. Here is an example:

```yaml
jobs:
  echo:
    runs-on: ubuntu-latest
    steps:
      - name: Test
        if: github.event_name == 'push'
        run: echo "I was triggered by a push event"
```

---

## PL — Opis ćwiczenia
W tym ćwiczeniu praktycznym naszym celem jest pogłębienie wiedzy o tym, jak używać wyrażeń.

Oto instrukcje do ćwiczenia:

1. Utwórz plik o nazwie `07-expressions.yaml` w folderze `.github/workflows` w katalogu głównym repozytorium.
2. Nazwij workflow: `07 – Using Expressions`.
3. Dodaj do workflow następujące wyzwalacze (triggery) wraz z filtrami i typami aktywności:
   - a. `push`
   - b. `workflow_dispatch`: w zdarzeniu `workflow_dispatch` zdefiniuj jedno wejście o nazwie `debug`, typu `boolean`, z domyślną wartością `false`.
4. Dodaj do workflow pojedynczą pracę (job) o nazwie `echo`. Job ma działać na `ubuntu-latest` i zawierać trzy kroki:
   - a. Pierwszy krok, nazwany `[debug] Print start-up data`, powinien wykonać się tylko wtedy, gdy wejście `inputs.debug` ma wartość `true`. Jeśli nie wiesz jak to zrobić, zajrzyj do sekcji **Tips** poniżej. Krok powinien uruchomić wielowierszowy skrypt wypisujący następujące dane:
     - i. `"Triggered by: <tu pobierz nazwę zdarzenia>"`
     - ii. `"Branch: <tu pobierz ref/gałąź>"`
     - iii. `"Commit SHA: <tu pobierz skrót commita>"`
     - iv. `"Runner OS: <tu pobierz system operacyjny runnera>"`
   - b. Drugi krok, nazwany `[debug] Print when triggered from main`, powinien wykonać się tylko wtedy, gdy `inputs.debug` ma wartość `true` **i** workflow został wywołany z gałęzi `main`. Krok powinien wypisać pojedynczą linię na ekranie: `"I was triggered from main"`.
   - c. Trzeci krok, nazwany `Greeting`, powinien wykonać się normalnie i wypisać komunikat `"Hello, world"`.
5. Zacommituj zmiany i wypchnij kod. Poświęć chwilę, by sprawdzić wynik uruchomienia workflow wywołanego zdarzeniem **push**.
6. Teraz uruchom workflow ręcznie z interfejsu UI, podając różne warianty dla wejścia `debug`, i sprawdź wyniki. Co się zmieniło?
7. Dodaj do definicji workflow właściwość `run-name`. Właściwość `run-name` powinna wypisywać komunikat: `07 – Using Expressions | DEBUG – <'ON' jeśli wejście debug ma wartość true, w przeciwnym razie 'OFF'>`
   - a. Wyrażenia umożliwiają ustawianie wartości domyślnych oraz działanie w stylu warunkowym (ternary). Wykorzystują do tego operatory logiczne `&&` i `||` w następujący sposób:
     - i. **Wartość domyślna:** `${{ expression || default_value }}`. `default_value` zostanie użyta, jeśli wyrażenie zwróci wartość „falsy”.
     - ii. **Operator trójargumentowy (ternary):** `${{ expression && truthy_value || falsy_value }}`. `truthy_value` zostanie użyta, jeśli wyrażenie zwróci wartość „truthy”, a `falsy_value` w przeciwnym razie. Końcowa wartość obliczona w wyrażeniu nie będzie obecna w samym wyniku tej operacji trójargumentowej.
8. Zacommituj zmiany i wypchnij kod. Poświęć chwilę, by sprawdzić wynik uruchomienia workflow wywołanego zdarzeniem **push**.
9. Teraz uruchom workflow ręcznie z interfejsu UI, podając różne warianty dla wejścia `debug`, i sprawdź wyniki. Co się zmieniło?
10. Zmień wyzwalacze workflow tak, aby zawierały tylko `workflow_dispatch`, by zapobiec uruchamianiu workflow przy każdym pushu i nie zaśmiecać listy uruchomień.

### PL — Wskazówki (Tips)
**Warunkowe uruchamianie jobów i kroków**  
Aby uruchamiać joby i kroki warunkowo, możemy użyć słowa kluczowego `if` w definicji joba lub kroku. `if` przyjmuje wyrażenie; job lub krok wykona się, jeśli wyrażenie zwróci wartość „truthy”, w przeciwnym razie zostanie pominięty. Przykład:

```yaml
jobs:
  echo:
    runs-on: ubuntu-latest
    steps:
      - name: Test
        if: github.event_name == 'push'
        run: echo "I was triggered by a push event"
```
